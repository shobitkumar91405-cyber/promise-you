<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alight Motion Web Translation</title>
    <style>
        /* Base Reset & Variables */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            background-color: #111; 
            color: #fff; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* Video Comp Container (Aspect Ratio 1080x1350 -> 4:5) */
        #comp-container {
            position: relative;
            width: 100%;
            max-width: 400px; /* Mobile responsive base */
            aspect-ratio: 4 / 5;
            background-color: #000;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
            border-radius: 8px;
        }

        /* Scene Management */
        .scene {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0;
            pointer-events: none;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            perspective: 1000px;
        }
        .scene.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Approximated Animation Classes */
        .anim-scale-up { animation: scaleUp 4s cubic-bezier(0.0, 1.0, 0.35, 1.0) forwards; }
        .anim-slide-rotate { animation: slideRotate 6s ease-in-out forwards; }
        .anim-page-curl-sim { animation: pageCurlSim 4s cubic-bezier(0.66, 0.01, 0.39, 0.99) forwards; transform-origin: left center; }
        .anim-pop-in { animation: popIn 2s cubic-bezier(0.67, 0.0, 0.34, 1.0) forwards; }

        @keyframes scaleUp {
            0% { transform: scale(2.04); opacity: 0; }
            30% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.5); }
        }
        @keyframes slideRotate {
            0% { transform: translateY(50%) rotate(-10deg) scale(0.8); opacity: 0; }
            20% { transform: translateY(0) rotate(0) scale(1); opacity: 1; }
            100% { transform: translateY(-20%) rotate(5deg) scale(1.2); }
        }
        /* CSS Approximation of Alight Motion's PageCurl */
        @keyframes pageCurlSim {
            0% { transform: rotateY(0deg) scale(1); opacity: 1; }
            50% { transform: rotateY(90deg) scale(1.1); opacity: 0.5; }
            100% { transform: rotateY(180deg) scale(1.2); opacity: 0; display: none; }
        }
        @keyframes popIn {
            0% { transform: scale(0) translateY(50px); opacity: 0; }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }

        /* Elements */
        .dynamic-image {
            position: absolute;
            width: 80%;
            height: 60%;
            background-color: #333;
            background-size: cover;
            background-position: center;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(182, 89, 245, 0.5); /* Deepglow approx */
        }
        .editable-text {
            position: absolute;
            font-size: 2.5rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.8);
            z-index: 10;
            outline: none;
            text-align: center;
        }

        /* UI Controls Overlay */
        #ui-controls {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 400px;
            background: #222;
            padding: 15px;
            border-radius: 8px;
        }
        button, input[type="file"] {
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: #ffb659;
            color: #000;
            font-weight: bold;
            cursor: pointer;
        }
        button:hover { background: #ff9800; }
        
        /* Specific Scene Styling */
        #scene1 .editable-text { bottom: 10%; color: #005cab; font-family: serif; }
        #scene2 .editable-text { top: 20%; color: #fff; }
        #scene3 .editable-text { color: #00ff00; transform: rotate(-15deg); }
        #scene4 .editable-text { font-size: 4rem; }
    </style>
</head>
<body>

    <div id="comp-container">
        
        <div id="scene1" class="scene" data-start="0" data-end="4199">
            <div class="dynamic-image anim-scale-up" id="img-slot-1"></div>
            <div class="editable-text anim-pop-in" contenteditable="true" style="animation-delay: 3.3s;">Aapko</div>
        </div>

        <div id="scene2" class="scene" data-start="4183" data-end="10265">
            <div class="dynamic-image anim-page-curl-sim" id="img-slot-2"></div>
            <div class="dynamic-image anim-slide-rotate" id="img-slot-3" style="animation-delay: 1.3s;"></div>
            <div class="editable-text anim-pop-in" contenteditable="true">Phir...</div>
            <div class="editable-text anim-pop-in" contenteditable="true" style="bottom: 20%; animation-delay: 1.3s;">Beqaraari</div>
        </div>

        <div id="scene3" class="scene" data-start="10250" data-end="12749">
            <div class="dynamic-image anim-scale-up" id="img-slot-4"></div>
            <div class="editable-text anim-pop-in" contenteditable="true">Sambhale</div>
        </div>

        <div id="scene4" class="scene" data-start="12733" data-end="14399">
            <div class="editable-text anim-scale-up" contenteditable="true" style="top: 30%;">Nahi</div>
            <div class="editable-text anim-scale-up" contenteditable="true" style="bottom: 30%; animation-delay: 0.5s;">Ye</div>
        </div>

        <div id="scene5" class="scene" data-start="17216" data-end="18849">
            <div class="dynamic-image anim-pop-in" id="img-slot-5" style="border-radius: 50%;"></div>
            <div class="editable-text anim-pop-in" contenteditable="true" style="bottom: 15%; font-size: 1.5rem; color: #00ff00;">EDITED BY MOHIT</div>
        </div>

    </div>

    <audio id="bg-audio" loop src="tere-liye.mp3"></audio>

    <div id="ui-controls">
        <button id="play-btn">â–¶ Play Animation & Music</button>
        <button id="reset-btn">ðŸ”„ Reset</button>
        
        <label>Replace Images:</label>
        <input type="file" id="image-uploader" accept="image/*" multiple>
        <small style="color: #aaa;">Upload multiple images to populate the animation. Click text in the player to edit it.</small>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const scenes = document.querySelectorAll('.scene');
            const playBtn = document.getElementById('play-btn');
            const resetBtn = document.getElementById('reset-btn');
            const audio = document.getElementById('bg-audio');
            const uploader = document.getElementById('image-uploader');
            const imgSlots = document.querySelectorAll('.dynamic-image');
            
            let startTime = null;
            let animationFrameId = null;
            let isPlaying = false;
            const TOTAL_DURATION = 18849; // From XML totalTime

            // Handle Image Uploads to replace placeholders
            uploader.addEventListener('change', (e) => {
                const files = e.target.files;
                if (!files.length) return;

                for (let i = 0; i < Math.min(files.length, imgSlots.length); i++) {
                    const file = files[i];
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        imgSlots[i].style.backgroundImage = `url(${event.target.result})`;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Core Animation Loop (requestAnimationFrame)
            function tick(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;

                // Sync scenes based on XML timestamps
                scenes.forEach(scene => {
                    const start = parseInt(scene.getAttribute('data-start'));
                    const end = parseInt(scene.getAttribute('data-end'));

                    if (elapsed >= start && elapsed <= end) {
                        if (!scene.classList.contains('active')) {
                            scene.classList.add('active');
                            // Retrigger CSS animations for smooth playback
                            const elements = scene.querySelectorAll('[class*="anim-"]');
                            elements.forEach(el => {
                                el.style.animation = 'none';
                                el.offsetHeight; /* trigger reflow */
                                el.style.animation = null; 
                            });
                        }
                    } else {
                        scene.classList.remove('active');
                    }
                });

                if (elapsed < TOTAL_DURATION && isPlaying) {
                    animationFrameId = requestAnimationFrame(tick);
                } else if (elapsed >= TOTAL_DURATION) {
                    isPlaying = false;
                    playBtn.innerText = "â–¶ Replay";
                }
            }

            // Play / Pause controls
            playBtn.addEventListener('click', () => {
                if (!isPlaying) {
                    isPlaying = true;
                    startTime = performance.now();
                    audio.play().catch(e => console.log("Audio play prevented by browser policy", e));
                    playBtn.innerText = "â¸ Playing...";
                    requestAnimationFrame(tick);
                }
            });

            // Reset controls
            resetBtn.addEventListener('click', () => {
                isPlaying = false;
                cancelAnimationFrame(animationFrameId);
                audio.pause();
                audio.currentTime = 0;
                startTime = null;
                playBtn.innerText = "â–¶ Play Animation & Music";
                scenes.forEach(scene => scene.classList.remove('active'));
            });
        });
    </script>
</body>
</html>
